# 更新日志 (Changelog)

本项目所有值得注意的变更都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [0.1.0] - 2024-02-21

### 新增
- 初始化项目基础结构
- 创建基本目录架构
- 设置conda环境配置
- 添加项目文档
- 配置示例文件
- 添加loguru日志系统
  - 支持控制台彩色输出
  - 支持文件日志按大小轮转（1MB）
  - 支持日志文件保留时间（7天）
  - 支持日志文件压缩
  - 支持多环境配置（dev/prod等）
  - 添加完整的测试用例
- 创建FastAPI应用入口
- 添加依赖
  - PyYAML 6.0.1 用于配置文件解析

### 变更
- 项目名称更改为 Lithium
- 虚拟环境名称更改为 lithium
- 数据库文件名更改为 lithium.db
- 优化日志配置结构，改用更清晰的层次结构
- 将日志模块移动到 utils 目录
- 简化配置加载逻辑，移除独立的配置模块

### 修复
- 无

### 移除
- 移除独立的配置加载模块

### 安全
- 无

## [2024-01-20]

### 改进
- 优化了日志系统的链路追踪功能
  - 使用`contextvars`重构了`trace_id`的存储机制，确保线程安全
  - 简化了`trace_id`格式，使用UUID的前8位作为追踪ID
  - 新增`TracedLogger`类，自动集成追踪功能
  - 添加了`TraceIDFilter`过滤器，自动为每条日志添加trace_id
  - 优化了日志格式，使用竖线分隔各个字段，提高可读性
  - 为所有日志处理器启用了异步写入功能
  - 完善了日志配置的错误处理机制
  - 增强了日志格式化功能，完全兼容loguru的格式化API
  - 改进了日志配置文件中的格式定义，确保trace_id正确显示
  - 为控制台日志添加了彩色显示支持，使trace_id更醒目
- 更新了日志使用示例（examples/logger_demo.py）
  - 添加了链路追踪功能的完整示例
  - 新增了上下文日志记录的示例
  - 改进了异步日志记录的示例
  - 优化了示例代码的组织结构
  - 简化了示例代码，使其更加清晰和易懂
  - 改进了结构化日志的记录方式，使用更优雅的格式化方法

### 修复
- 修复了`TracedLogger`不支持loguru风格格式化的问题
- 修复了上下文管理相关的类型错误
- 修复了trace_id在日志中不显示的问题
- 修复了trace_id为None时的格式化问题

### 移除
- 无

### 安全
- 无 